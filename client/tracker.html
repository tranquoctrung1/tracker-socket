<!doctype html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Quản lý Liên kết Tracker</title>
        <link rel="stylesheet" href="./styles/beacon.css" />
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
            rel="stylesheet"
        />
        <style>
            .status-connected {
                color: #27ae60;
                font-weight: bold;
            }
            .status-available {
                color: #7f8c8d;
                font-weight: bold;
            }
            .user-info {
                background: #f8f9fa;
                padding: 8px 12px;
                border-radius: 6px;
                margin: 5px 0;
            }
            .user-name {
                font-weight: bold;
                color: #2c3e50;
            }
            .user-email {
                color: #7f8c8d;
                font-size: 0.9em;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <header>
                <h1><i class="fas fa-link"></i> Quản lý Liên kết Tracker</h1>
                <p>Quản lý liên kết giữa người dùng và thiết bị tracker</p>
            </header>

            <!-- Thống kê -->
            <div class="stats-section">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-broadcast-tower"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalTrackers">0</h3>
                        <p>Tổng Tracker</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="connectedTrackers">0</h3>
                        <p>Tracker Đã Liên kết</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-user-times"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="availableTrackers">0</h3>
                        <p>Tracker Trống</p>
                    </div>
                </div>
            </div>

            <div class="df">
                <button
                    class="btn btn-change"
                    onclick="onChangeMainPageClicked()"
                >
                    Trang chính
                </button>
                <button
                    class="btn btn-change"
                    onclick="onChangeBeaconPageClicked()"
                >
                    Khai báo beacon
                </button>
                <button
                    class="btn btn-change"
                    onclick="onChangeAlarmAreaPageClicked()"
                >
                    Khai báo khu vực cánh báo
                </button>
            </div>
            <!-- Bộ lọc và tìm kiếm -->
            <div class="search-section">
                <div class="search-container">
                    <input
                        type="text"
                        id="searchInput"
                        placeholder="Tìm kiếm theo Tracker ID, Device ID..."
                    />
                    <button id="searchBtn" class="btn btn-search">
                        <i class="fas fa-search"></i> Tìm kiếm
                    </button>
                    <button id="clearSearch" class="btn btn-clear">
                        <i class="fas fa-times"></i> Xóa
                    </button>
                </div>

                <div class="filter-container">
                    <select id="statusFilter">
                        <option value="">Tất cả trạng thái</option>
                        <option value="connected">Đã liên kết</option>
                        <option value="available">Chưa liên kết</option>
                    </select>
                </div>
            </div>

            <!-- Bảng tracker -->
            <div class="list-section">
                <h2><i class="fas fa-list"></i> Danh sách Tracker</h2>
                <div class="table-container">
                    <table id="trackersTable">
                        <thead>
                            <tr>
                                <th>Tracker ID</th>
                                <th>Device ID</th>
                                <th>Trạng thái</th>
                                <th>Người dùng liên kết</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="trackersTableBody">
                            <!-- Dữ liệu tracker sẽ được tải ở đây -->
                        </tbody>
                    </table>
                </div>
                <div class="loading" id="loading">Đang tải dữ liệu...</div>
                <div class="no-data" id="noData" style="display: none">
                    Không tìm thấy tracker nào
                </div>
            </div>
        </div>

        <!-- Modal xác nhận hủy liên kết -->
        <div id="unlinkModal" class="modal">
            <div class="modal-content">
                <h3><i class="fas fa-unlink"></i> Xác nhận hủy liên kết</h3>
                <p id="unlinkMessage">
                    Bạn có chắc chắn muốn hủy liên kết tracker này?
                </p>
                <div class="modal-actions">
                    <button id="confirmUnlink" class="btn btn-danger">
                        <i class="fas fa-unlink"></i> Hủy liên kết
                    </button>
                    <button id="cancelUnlink" class="btn btn-secondary">
                        Hủy bỏ
                    </button>
                </div>
            </div>
        </div>
        <script src="./js/hostname.js"></script>
        <script src="./js/tracker.js"></script>
    </body>
</html>
